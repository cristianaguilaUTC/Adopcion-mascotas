{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Adopción Mascotas CAA{% endblock %}</title>
    <link rel="icon" type="image/png" href="{% static 'logo.png' %}">
    
    <!-- CSS y JS principales -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'mazer/dist/assets/css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'mazer/dist/assets/css/app.css' %}">
    <link rel="stylesheet" href="{% static 'toast.css' %}">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

    <!-- jQuery y Validaciones -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        .error { color: red; font-weight: bold; }
        .form-control.error { border: 1px solid red; }
    </style>

    {% block extra_head %}{% endblock %}
</head>
<body>
    <div id="app">
        <div id="sidebar" class="active">
            <div class="sidebar-wrapper active">
                <div class="sidebar-header">
                    <div class="d-flex justify-content-between">
                        <center>
                        <img  src="{% static 'logo.png' %}" alt="logo" style="width: 70%; height: 100%;"></center>
                        <div class="toggler">
                            <a href="#" class="sidebar-hide d-xl-none d-block"><i class="bi bi-x bi-middle"></i></a>
                        </div>
                    </div>
                </div>
                <div class="sidebar-menu">
                    <ul class="menu">
                        <li class="sidebar-title">Menú</li>

                        <!-- MASCOTAS - Todos los usuarios -->
                        <li class="sidebar-item {% if request.path == '/mascotas/' %}active{% endif %}">
                            <a href="{% url 'inicio' %}" class='sidebar-link'>
                                <i class="bi bi-globe2"></i>
                                <span>Mascotas</span>
                            </a>
                        </li>

                        <!-- PERSONAS - Solo admins -->
                        {% if request.user.is_authenticated %}
                            {% with user.persona as persona %}
                                {% if persona.es_admin %}
                                <li class="sidebar-item {% if request.path == '/personas/' %}active{% endif %}">
                                    <a href="{% url 'inicio_personas' %}" class='sidebar-link'>
                                        <i class="bi bi-building"></i>
                                        <span>Dueño / Rescatista</span>
                                    </a>
                                </li>

                                <li class="sidebar-item {% if request.path == '/adopciones/' %}active{% endif %}">
                                    <a href="{% url 'inicio_adopciones' %}" class='sidebar-link'>
                                        <i class="bi bi-book-fill"></i>
                                        <span>Adopción</span>
                                    </a>
                                </li>

                                <li class="sidebar-item {% if request.path == '/adopciones/dashboard/' %}active{% endif %}">
                                    <a href="{% url 'dashboard' %}" class="sidebar-link">
                                      <i class="bi bi-graph-up"></i>
                                      <span>Inteligencia de Negocios</span>
                                    </a>
                                  </li>
                                {% else %}
                                <!-- Para usuarios normales: Dashboard -->
                                <li class="sidebar-item {% if request.path == '/dashboard/' %}active{% endif %}">
                                    <a href="{% url 'dashboard_usuario' %}" class='sidebar-link'>
                                        <i class="bi bi-house"></i>
                                        <span>Mi sitio</span>
                                    </a>
                                </li>
                                {% endif %}
                            {% endwith %}
                        {% endif %}

                        <!-- Cerrar Sesión -->
                        <li class="sidebar-item">
                            <a href="{% url 'logout' %}" class='sidebar-link' style="color: #dc3545;">
                                <i class="bi bi-box-arrow-right"></i>
                                <span>Cerrar Sesión</span>
                            </a>
                        </li>

                    </ul>
                </div>
                <button class="sidebar-toggler btn x"><i data-feather="x"></i></button>
            </div>
        </div>

        <!-- Contenido dinámico -->
        <div id="main">
            <header class="mb-3">
                <a href="#" class="burger-btn d-block d-xl-none">
                    <i class="bi bi-justify fs-3"></i>
                </a>
            </header>

            {% block contenido %}{% endblock %}

            <!-- Footer -->
            <footer>
                <div class="footer clearfix mb-0 text-muted">
                    <div class="float-end">
                        <p>2025 &copy; Hecho por <a href="#">Cristian Aguila, Alejandra Erreyes, Alex Iza</a></p>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Scripts base -->
    <script src="{% static 'mazer/dist/assets/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/validations.js' %}"></script>

    {% block extra_js %}{% endblock %}
    
    <!-- SweetAlert para mensajes -->
    <script>
    // Mostrar mensajes de Django con SweetAlert
    {% if messages %}
        {% for message in messages %}
            Swal.fire({
                icon: '{{ message.tags }}' === 'error' ? 'error' : 'success',
                title: '{{ message|safe }}',
                showConfirmButton: false,
                timer: 3000
            });
        {% endfor %}
    {% endif %}

    // Función para confirmar eliminaciones
    function confirmarEliminacion(mensaje, url) {
        Swal.fire({
            title: '¿Estás seguro?',
            text: mensaje,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#dc3545',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Sí, eliminar',
            cancelButtonText: 'Cancelar'
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = url;
            }
        });
    }
    </script>
<script>
   
STATIC_URL = 'static/'
STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')
STATICFILES_DIRS = [ 
    os.path.join(BASE_DIR, 'AdopcionMascota/static'), 
    os.path.join(BASE_DIR, 'static'), 
]


TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [
            os.path.join(BASE_DIR, 'templates'), 
        ],
        'APP_DIRS': True,   
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
</script>
</body>
</html>
